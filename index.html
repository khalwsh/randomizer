<!doctype html>
<html lang="en">
    
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>
            Constrained Equal-Sized Grouping
        </title>
        <link rel="stylesheet" href="style.css">
    </head>
    
    <body>
        <div class="wrap">
            <header>
                <h1>
                    Constrained Equal-Sized Grouping
                </h1>
                <p class="lead">
                    Enter items, define "must-be-together" pairs, set number of groups — this
                    will try to produce
                    <strong>
                        equal-sized
                    </strong>
                    groups respecting pairs. Toggle "allow ±1" to accept near-equal groups
                    when exact equality is impossible.
                </p>
            </header>
            <section class="left">
                <div class="card">
                    <label for="itemsTxt">
                        Items (one per line, or comma separated)
                    </label>
                    <textarea id="itemsTxt" placeholder="e.g., Alice&#10;Bob&#10;Charlie"></textarea>
                    <div class="row">
                        <button class="btn" id="addItemsBtn">
                            Add Items
                        </button>
                        <button class="btn secondary" id="clearItemsBtn">
                            Clear All
                        </button>
                        <div style="margin-left:auto" class="small">
                            Items:
                            <span id="itemsCount">
                                0
                            </span>
                        </div>
                    </div>
                    <div class="items-list" id="itemsList" aria-live="polite" style="margin-top:12px">
                    </div>
                    <hr style="border:none;height:1px;background:rgba(255,255,255,0.02);margin:12px 0">
                    <label>
                        Make a "must-be-together" pair
                    </label>
                    <div class="controls">
                        <select id="itemA">
                            <option value="">
                                Choose item A
                            </option>
                        </select>
                        <select id="itemB">
                            <option value="">
                                Choose item B
                            </option>
                        </select>
                        <button class="btn" id="addPairBtn">
                            Add Pair
                        </button>
                    </div>
                    <ul class="pairs-list" id="pairsList" aria-live="polite">
                    </ul>
                    <div class="row" style="margin-top:12px">
                        <label style="margin-right:8px">
                            Number of groups
                        </label>
                        <input type="number" id="numGroups" min="1" value="1" style="width:80px">
                        <label style="margin-left:12px">
                            <input type="checkbox" id="allowNear">
                            Allow groups to differ by at most ±1
                        </label>
                    </div>
                    <div class="actions">
                        <button class="btn" id="generateBtn">
                            Generate Groupings
                        </button>
                        <button class="btn secondary" id="randomizeNamesBtn" title="Shuffle item order before generating">
                            Shuffle Items
                        </button>
                    </div>
                    <div id="error" class="error" role="status" aria-live="assertive">
                    </div>
                </div>
            </section>
            <aside>
                <div class="card">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <div>
                            <strong>
                                Results
                            </strong>
                            <div class="small">
                                Each card is a partition that respects all pairs and group capacity rules.
                            </div>
                        </div>
                        <div style="text-align:right">
                            <button class="download" id="downloadAllBtn">
                                Download JSON
                            </button>
                        </div>
                    </div>
                    <div id="results" class="groups-out" style="margin-top:12px">
                        <!-- groupings appear here -->
                    </div>
                    <div style="margin-top:12px" class="small">
                        If exact equal groups are impossible, try checking "Allow ±1". Large inputs
                        may take longer to find solutions.
                    </div>
                </div>
            </aside>
            <footer>
                Uses union-find to merge "must" pairs into components, then packs components
                into equal-capacity bins (backtracking search). If a component is larger
                than any group capacity, grouping is impossible.
            </footer>
        </div>
        <script src="index.js">
        </script>
    </body>

</html>